from .base_test import BaseTest

class LoveLanguageTest(BaseTest):
    def __init__(self):
        super().__init__("love_language")
        self.love_languages = {
            "words": "–°–ª–æ–≤–∞ –ø–æ–æ—â—Ä–µ–Ω–∏—è üí¨",
            "time": "–í—Ä–µ–º—è –≤–º–µ—Å—Ç–µ ‚è∞", 
            "gifts": "–ü–æ–¥–∞—Ä–∫–∏ üéÅ",
            "service": "–ê–∫—Ç—ã —Å–ª—É–∂–µ–Ω–∏—è ü§ù",
            "touch": "–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏–µ ‚úã"
        }
        self.setup_questions()
    
    def setup_questions(self):
        self.questions = [
            {
                "text": "üíù –ß—Ç–æ –¥–ª—è –≤–∞—Å –≤–∞–∂–Ω–µ–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö?",
                "type": "choice",
                "options": [
                    "üí¨ –°–ª—ã—à–∞—Ç—å —Å–ª–æ–≤–∞ –ª—é–±–≤–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
                    "‚è∞ –ü—Ä–æ–≤–æ–¥–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤–º–µ—Å—Ç–µ",
                    "üéÅ –ü–æ–ª—É—á–∞—Ç—å –∑–Ω–∞–∫–∏ –≤–Ω–∏–º–∞–Ω–∏—è –∏ –ø–æ–¥–∞—Ä–∫–∏",
                    "ü§ù –ö–æ–≥–¥–∞ –ø–∞—Ä—Ç–Ω–µ—Ä –ø–æ–º–æ–≥–∞–µ—Ç –≤ –¥–µ–ª–∞—Ö",
                    "‚úã –§–∏–∑–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å –∏ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏—è"
                ]
            },
            {
                "text": "üíù –ö–∞–∫ –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –ø—Ä–æ—è–≤–ª—è—Ç—å –ª—é–±–æ–≤—å?",
                "type": "choice",
                "options": [
                    "üí¨ –ì–æ–≤–æ—Ä–∏—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã –∏ —Å–ª–æ–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
                    "‚è∞ –û—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
                    "üéÅ –î–∞—Ä–∏—Ç—å –ø–æ–¥–∞—Ä–∫–∏ –∏ —Å—é—Ä–ø—Ä–∏–∑—ã",
                    "ü§ù –ü–æ–º–æ–≥–∞—Ç—å —Å –¥–µ–ª–∞–º–∏ –∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏",
                    "‚úã –û–±–Ω–∏–º–∞—Ç—å, –¥–µ—Ä–∂–∞—Ç—å –∑–∞ —Ä—É–∫—É"
                ]
            },
            {
                "text": "üíù –ß—Ç–æ —Ä–∞–Ω–∏—Ç –≤–∞—Å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
                "type": "choice", 
                "options": [
                    "üí¨ –ö—Ä–∏—Ç–∏–∫–∞ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ—Ö–≤–∞–ª—ã",
                    "‚è∞ –û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–ª–∞–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –≤–Ω–∏–º–∞–Ω–∏—è",
                    "üéÅ –ó–∞–±—ã—Ç—ã–µ –¥–∞—Ç—ã –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥–∞—Ä–∫–æ–≤",
                    "ü§ù –ù–µ–∂–µ–ª–∞–Ω–∏–µ –ø–æ–º–æ—á—å –≤ –≤–∞–∂–Ω—ã—Ö –¥–µ–ª–∞—Ö",
                    "‚úã –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞"
                ]
            },
            {
                "text": "üíù –ö–∞–∫–æ–π –ø–æ–¥–∞—Ä–æ–∫ –≤—ã —Ü–µ–Ω–∏—Ç–µ –±–æ–ª—å—à–µ?",
                "type": "choice",
                "options": [
                    "üí¨ –ò—Å–∫—Ä–µ–Ω–Ω–µ–µ –ø–∏—Å—å–º–æ –∏–ª–∏ —Å—Ç–∏—Ö–∏",
                    "‚è∞ –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –∏–ª–∏ —É–∂–∏–Ω",
                    "üéÅ –î–æ—Ä–æ–≥–æ–π –∏ –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫",
                    "ü§ù –ü–æ–º–æ—â—å –≤ —Ä–µ—à–µ–Ω–∏–∏ —Å–ª–æ–∂–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã",
                    "‚úã –ú–∞—Å—Å–∞–∂ –∏–ª–∏ –Ω–µ–∂–Ω—ã–µ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏—è"
                ]
            },
            {
                "text": "üíù –ß—Ç–æ –¥–ª—è –≤–∞—Å –∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ?",
                "type": "choice",
                "options": [
                    "üí¨ –î–æ–ª–≥–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä –ø–æ –¥—É—à–∞–º",
                    "‚è∞ –ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö –∏–ª–∏ —Ö–æ–±–±–∏ –≤–º–µ—Å—Ç–µ",
                    "üéÅ –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —É–∂–∏–Ω —Å –ø–æ–¥–∞—Ä–∫–æ–º",
                    "ü§ù –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π –∑–∞–¥–∞—á–∏",
                    "‚úã –û–±—ä—è—Ç–∏—è –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å"
                ]
            }
        ]
    
    def calculate_result(self):
        language_scores = {key: 0 for key in self.love_languages.keys()}
        language_map = {
            0: "words", 1: "time", 2: "gifts", 3: "service", 4: "touch"
        }
        
        for answer_index in self.answers:
            language_key = language_map[answer_index]
            language_scores[language_key] += 1
        
        return language_scores
    
    def generate_report(self, results):
        primary_language = max(results.items(), key=lambda x: x[1])
        secondary_language = sorted(results.items(), key=lambda x: x[1], reverse=True)[1]
        
        language_descriptions = {
            "words": "–í—ã —Ü–µ–Ω–∏—Ç–µ –≤–µ—Ä–±–∞–ª—å–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ —á—É–≤—Å—Ç–≤. –ö–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã, —Å–ª–æ–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –∏—Å–∫—Ä–µ–Ω–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–∞–ø–æ–ª–Ω—è—é—Ç –≤–∞—Å –ª—é–±–æ–≤—å—é.",
            "time": "–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤–º–µ—Å—Ç–µ - –≤–∞—à —è–∑—ã–∫ –ª—é–±–≤–∏. –°–æ–≤–º–µ—Å—Ç–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è –∏ –±–µ–∑—Ä–∞–∑–¥–µ–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∑–Ω–∞—á–∞—Ç –¥–ª—è –≤–∞—Å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ.",
            "gifts": "–ü–æ–¥–∞—Ä–∫–∏ –∏ –∑–Ω–∞–∫–∏ –≤–Ω–∏–º–∞–Ω–∏—è - –≤–∞—à —Å–ø–æ—Å–æ–± –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ª—é–±–≤–∏. –í–∞–º –≤–∞–∂–Ω—ã –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã–µ –∂–µ—Å—Ç—ã –∏ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–∞—Ä–∫–∏.",
            "service": "–ê–∫—Ç—ã —Å–ª—É–∂–µ–Ω–∏—è –≥–æ–≤–æ—Ä—è—Ç –≤–∞–º –æ –ª—é–±–≤–∏. –ü–æ–º–æ—â—å –≤ –¥–µ–ª–∞—Ö, –∑–∞–±–æ—Ç–∞ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ - –≤–∞—à–∏ –∫–ª—é—á–µ–≤—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏.",
            "touch": "–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏–µ - –≤–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ª—é–±–≤–∏. –û–±—ä—è—Ç–∏—è, –ø–æ—Ü–µ–ª—É–∏ –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –≤–∞–º –¥–ª—è —á—É–≤—Å—Ç–≤–∞ —Å–≤—è–∑–∏."
        }
        
        report = f"""
üíù **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –Ω–∞ —è–∑—ã–∫–∏ –ª—é–±–≤–∏**

**–í–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ª—é–±–≤–∏:**
{self.love_languages[primary_language[0]]} - {primary_language[1]}/5 –±–∞–ª–ª–æ–≤

**–í—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —è–∑—ã–∫:**
{self.love_languages[secondary_language[0]]} - {secondary_language[1]}/5 –±–∞–ª–ª–æ–≤

üìä **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤:**
{self.format_scores(results)}

üí° **–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ —è–∑—ã–∫–∞ –ª—é–±–≤–∏:**
{language_descriptions[primary_language[0]]}

ü§ù **–°–æ–≤–µ—Ç—ã –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞:**
{self.get_partner_advice(primary_language[0])}

‚ù§Ô∏è **–ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –ª—É—á—à–µ –≤—ã—Ä–∞–∂–∞—Ç—å –ª—é–±–æ–≤—å:**
{self.get_self_advice(primary_language[0])}
"""
        return report
    
    def format_scores(self, scores):
        lines = []
        for lang, score in sorted(scores.items(), key=lambda x: x[1], reverse=True):
            lines.append(f"‚Ä¢ {self.love_languages[lang]}: {score}/5")
        return "\n".join(lines)
    
    def get_partner_advice(self, language):
        advice = {
            "words": "–ß–∞—â–µ –≥–æ–≤–æ—Ä–∏—Ç–µ —Å–ª–æ–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –ø–∏—à–∏—Ç–µ –ª—é–±–æ–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∫–∏, —Ö–≤–∞–ª–∏—Ç–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.",
            "time": "–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤–º–µ—Å—Ç–µ, –±—É–¥—å—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º –≤–æ –≤—Ä–µ–º—è –æ–±—â–µ–Ω–∏—è.",
            "gifts": "–î–µ–ª–∞–π—Ç–µ –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏, –ø–æ–º–Ω–∏—Ç–µ –æ –≤–∞–∂–Ω—ã—Ö –¥–∞—Ç–∞—Ö, surprise-—Å—é—Ä–ø—Ä–∏–∑—ã.",
            "service": "–ü—Ä–µ–¥–ª–∞–≥–∞–π—Ç–µ –ø–æ–º–æ—â—å –≤ –¥–µ–ª–∞—Ö, –±–µ—Ä–∏—Ç–µ –Ω–∞ —Å–µ–±—è —á–∞—Å—Ç—å –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π, –ø—Ä–æ—è–≤–ª—è–π—Ç–µ –∑–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ –¥–µ–π—Å—Ç–≤–∏—è.",
            "touch": "–ß–∞—â–µ –æ–±–Ω–∏–º–∞–π—Ç–µ, –¥–µ—Ä–∂–∏—Ç–µ –∑–∞ —Ä—É–∫—É, –ø—Ä–æ—è–≤–ª—è–π—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –Ω–µ–∂–Ω–æ—Å—Ç—å."
        }
        return advice[language]
    
    def get_self_advice(self, language):
        advice = {
            "words": "–£—á–∏—Ç–µ—Å—å –≤—ã—Ä–∞–∂–∞—Ç—å —á—É–≤—Å—Ç–≤–∞ —Å–ª–æ–≤–∞–º–∏, –≥–æ–≤–æ—Ä–∏—Ç–µ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã, –¥–µ–ª–∏—Ç–µ—Å—å –º—ã—Å–ª—è–º–∏.",
            "time": "–ü—Ä–µ–¥–ª–∞–≥–∞–π—Ç–µ —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è, –±—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–º —Å–ª—É—à–∞—Ç–µ–ª–µ–º, –ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –≤—Ä–µ–º—è –≤–º–µ—Å—Ç–µ.",
            "gifts": "–î–µ–ª–∞–π—Ç–µ –Ω–µ–±–æ–ª—å—à–∏–µ –ø–æ–¥–∞—Ä–∫–∏-—Å—é—Ä–ø—Ä–∏–∑—ã, –ø–æ–º–Ω–∏—Ç–µ –æ –≤–∞–∂–Ω—ã—Ö –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –º–µ–ª–æ—á–∞—Ö.",
            "service": "–ü—Ä–æ—è–≤–ª—è–π—Ç–µ –∑–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ –ø–æ–º–æ—â—å, –±–µ—Ä–∏—Ç–µ –Ω–∞ —Å–µ–±—è —á–∞—Å—Ç—å –¥–µ–ª, –±—É–¥—å—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–º –ø–æ–º–æ—â–Ω–∏–∫–æ–º.",
            "touch": "–ß–∞—â–µ –ø—Ä–∏–∫–∞—Å–∞–π—Ç–µ—Å—å –∫ –ø–∞—Ä—Ç–Ω–µ—Ä—É, –æ–±–Ω–∏–º–∞–π—Ç–µ, –ø—Ä–æ—è–≤–ª—è–π—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –±–ª–∏–∑–æ—Å—Ç—å."
        }
        return advice[language]